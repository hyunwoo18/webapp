const functions = require('firebase-functions');

const cors = require('cors')({
	origin: true,
    });

var admin = require('firebase-admin');
admin.initializeApp(  functions.config().firebase  );

exports.hkHello = functions.https.onRequest( (request, response) => {

	let inviter_id;
	let invitee_id;
	let answer = 'maybe';
	let level = 1;

	switch (  request.get('content-type')  ) {

	case 'application/json':
	    inviter_id = request.body.inviter;
	    invitee_id = request.body.invitee;
            break;
	}

	console.log( "inviter" )
	console.log( inviter_id )
	console.log( "invitee" )
	console.log( invitee_id )

	let uploadarray2 = {
	    inviter: inviter_id,
	    invitee: invitee_id,
	    answerr: 'maybe',
	    level: 1
        };


	var hkref = admin.database().ref( 'users/' + invitee_id + '/friendrequests');
        var newrequest = hkref.push();
	newrequest.set( uploadarray2 );

	response.send("Hello from Firebase!");
});

